{% extends "base.html" %}

{% block title %}{{ page_title or site_title }}{% end %}
{% block description %}{{ page_desc or site_desc }}{% end %}

{% block page_class %}{{ page_class }}{% end %}


{% block main %}
<article>
    <header>
        <h1>{{ post.get('title') }}</h1>
        <time datetime="{{ post.get('created_at') }}">{{ post.get('created_at') }}</time>
    </header>
    {% raw post.get('body_html') %}
    <footer>
        {% if post.get('labels') %}
        <section>
            <h3>Labels</h3>
            <ul>
                {% for label in post.get('labels') %}
                <li>{{ label.get('name') }}</li>
                {% end %}
            </ul>
        </section>
        {% end %}
        {% if any(post.get('reactions').values()) %}
        <section>
            <h3>Reactions</h3>
            <ul>
                {% for emoji, count in post.get('reactions').items() %}
                    {% if count %}
                    <li>{{ emoji }} +{{ count }}</li>
                    {% end %}
                {% end %}
            </ul>
        </section>
        {% end %}
        {% if prev_post or next_post %}
        <section>
            <h3>Nav</h3>
            <nav>
                {% if prev_post %}
                <p>Prev: <a href="{{ prev_post.get('permanent_url') }}">{{ prev_post.get('title') }}</a></p>
                {% end %}
                {% if next_post %}
                <p>Next: <a href="{{ next_post.get('permanent_url') }}">{{ next_post.get('title') }}</a></p>
                {% end %}
            </nav>
        </section>
        {% end %}
        {% if related_posts %}
        <section>
            <h3>Related Posts</h3>
            <ul>
                {% for related_post in related_posts %}
                <li><a href="{{ related_post.get('permanent_url') }}">{{ related_post.get('title') }}</a></li>
                {% end %}
            </ul>
        </section>
        {% end %}
    </footer>
</article>
{% if comments %}
<div id="comments">
    <h2>Comments ({{ len(comments) }})</h2>
    {% for comment in comments %}
    <article>
        <header>
            {% set user = comment.get('user') %}
            <img src="{{ user.get('avatar_url') }}" alt="{{ user.get('login') }}">
            <strong>{{ user.get('login') }}</strong>
            <time datetime="{{ comment.get('created_at') }}">{{ comment.get('created_at') }}</time>
        </header>
        {% raw comment.get('body_html') %}
        {% if any(comment.get('reactions').values()) %}
        <footer>
            <ul>
                {% for emoji, count in comment.get('reactions').items() %}
                    {% if count %}
                    <li>{{ emoji }} +{{ count }}</li>
                    {% end %}
                {% end %}
            </ul>
        </footer>
        {% end %}
    </article>
    {% end %}
</div>
{% end %}
{% end %}

{% block side %}{% end %}